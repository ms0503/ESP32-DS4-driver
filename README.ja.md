# DualShock4 Input UART Transmitter on ESP32
- [English](README.md)

ESP32-DS4はDualShock4から信号を受け取り、32・33番ピンからUARTで出力するプログラムです。

# UARTパケット仕様
| ボーレート | データ長 | パリティ | ストップビット |
| :--------: | :------: | :------: | :------------: |
|  115200bps |  8ビット |    無し  |     1ビット    |

| byte |    0   |     1     |     2    |    3   |    4   |    5   |    6   |  7  |  8  |     9    |
| :--: | :----: | :-------: | :------: | :----: | :----: | :----: | :----: | :-: | :-: | :------: |
|      | HEADER | BTN\_HIGH | BTN\_LOW | ST\_RX | ST\_RY | ST\_LX | ST\_LY |  R2 |  L2 | CHECKSUM |

## HEADER
HEADERはデータの先頭を確認するためのものです。
値は0x80 (128)です。

## BTN\_HIGH
BTN\_HIGHはボタン状態の上位バイトです。
ボタンが押されていれば対応するビットがHIGHになり、そうでなければLOWになります。
以下のボタンが含まれます(下位ビットから):
- R1
- L1
- R3
- L3
- Options
- Share
- PSロゴ
- タッチパッド(押し込み)

## BTN\_LOW
BTN\_LOWはボタン状態の下位バイトです。
ボタンが押されていれば対応するビットがHIGHになり、そうでなければLOWになります。
以下のボタンが含まれます(下位ビットから):
- 丸
- 三角
- 四角
- バツ
- 十字ボタン右
- 十字ボタン上
- 十字ボタン左
- 十字ボタン下

## ST\_RX
ST\_RXは右スティックのX軸です。
値の向きは左から右です。

## ST\_RY
ST\_RYは右スティックのY軸です。
値の向きは下から上です。

## ST\_LX
ST\_LXは左スティックのX軸です。
値の向きは左から右です。

## ST\_LY
ST\_LYは左スティックのY軸です。
値の向きは下から上です。

## R2
R2はR2トリガーのアナログ値です。
最後まで押し込んだ時の値は0xff (255)です。

## L2
L2はL2トリガーのアナログ値です。
最後まで押し込んだ時の値は0xff (255)です。

## CHECKSUM
CHECKSUMはデータのチェックサムです。
1. HEADERからL2までを全て足す。
2. 8ビットから溢れた分のビットを切り捨てる。

# Driver
[ms0503/ESP32-DS4-driver](https://github.com/ms0503/ESP32-DS4-driver)はC++・Rust向けのシンプルなドライバーです。
